<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-T">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oportunidad de Inversi√≥n Lolocar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Visualization & Content Choices: 
        - Resumen Ejecutivo: Texto. Goal: Informar.
        - ‚ú® **Puntos Clave del Informe (Gemini API)**: Secci√≥n con bot√≥n para generar un resumen conciso del informe. Goal: Sintetizar, Informar. Justificaci√≥n: Permite una comprensi√≥n r√°pida de los aspectos m√°s importantes.
        - Comparaci√≥n Inversiones: Tabla HTML. Goal: Comparar.
        - Ventajas Lolocar: Lista HTML con iconos Unicode. Goal: Destacar.
        - An√°lisis Financiero (VAN/TIR): Gr√°ficos de barras agrupadas (Chart.js) para VAN y TIR, interactivos con botones para cambiar tasa de descuento (5%/10%). Goal: Analizar, Comparar. Justificaci√≥n: Claridad para datos financieros, interacci√≥n para exploraci√≥n de escenarios.
        - Observaciones Financieras: Texto din√°mico. Goal: Explicar.
        - ‚ú® **Generaci√≥n de An√°lisis R√°pido (Gemini API)**: Bot√≥n que activa una llamada a LLM para generar un resumen o insight sobre los datos financieros mostrados. Goal: Sintetizar, Informar. Justificaci√≥n: Proporciona valor a√±adido al usuario al ofrecer una interpretaci√≥n r√°pida de los datos complejos.
        - Rentabilidad con Venta: Texto y c√°lculos HTML. Goal: Informar, Cuantificar. Justificaci√≥n: Transparencia en el c√°lculo del valor residual.
        - ‚ú® **An√°lisis de Escenario Personalizado (Gemini API)**: Nueva secci√≥n con campos de entrada para monto, per√≠odo y retorno esperado. LLM genera un an√°lisis de viabilidad. Goal: Personalizar, Analizar. Justificaci√≥n: Permite al usuario explorar escenarios hipot√©ticos basados en sus propios intereses.
        - Riesgos y Mitigaciones: Lista HTML. Goal: Informar.
        - ‚ú® **Asistente de Evaluaci√≥n de Riesgos (Gemini API)**: Nueva funcionalidad en la secci√≥n de Riesgos. Permite al usuario preguntar sobre un riesgo espec√≠fico y la IA responde con la mitigaci√≥n del informe. Goal: Clarificar, Profundizar. Justificaci√≥n: Ofrece una interacci√≥n directa sobre las preocupaciones de riesgo.
        - ‚ú® **Generador de Argumentos de Venta (Gemini API)**: Nueva secci√≥n con campo de texto para definir p√∫blico/enfoque. LLM genera un argumento de venta persuasivo. Goal: Persuadir, Facilitar comunicaci√≥n. Justificaci√≥n: Ayuda al usuario a comunicar la oportunidad de manera efectiva.
        - ‚ú® **Preguntas a la IA (Gemini API)**: Secci√≥n con campo de texto y bot√≥n para que el usuario formule preguntas sobre el informe. La IA responde bas√°ndose en el contexto del informe. Goal: Clarificar, Explorar. Justificaci√≥n: Permite una interacci√≥n profunda y personalizada con el contenido del informe.
        - ‚ú® **Generar Invitaci√≥n Personalizada (Gemini API)**: Funcionalidad en la secci√≥n de Conclusi√≥n para generar un borrador de invitaci√≥n o mensaje. Goal: Facilitar la comunicaci√≥n, Persuadir. Justificaci√≥n: Proporciona una herramienta pr√°ctica para el usuario.
        - Conclusi√≥n y CTA: Texto y bot√≥n mailto. Goal: Persuadir, Accionar.
        Confirmaci√≥n: NO SVG/Mermaid. Todo con HTML/CSS/Tailwind y Chart.js (Canvas). -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 300px; max-height: 400px; }
        @media (min-width: 768px) { .chart-container { height: 350px; } }
        .tab-button.active { background-color: #E8316E; color: white; } /* Lolocar Pink */
        .tab-button { background-color: #e5e7eb; color: #374151; }
        html { scroll-behavior: smooth; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <header class="bg-[#050B3B] shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-3xl font-extrabold text-[#E8316E] tracking-tight">LOLO<span class="text-white text-2xl font-normal">car</span> <span class="text-gray-400 text-xl font-medium">Inversiones</span></a>
            <div class="space-x-6 hidden md:block">
                <a href="#puntos-clave" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">Puntos Clave</a>
                <a href="#comparativa" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">Comparativa</a>
                <a href="#analisis" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">An√°lisis Financiero</a>
                <a href="#rentabilidad-venta" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">Rentabilidad Venta</a>
                <a href="#analisis-personalizado" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">An√°lisis Personalizado</a>
                <a href="#riesgos" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">Riesgos</a>
                <a href="#argumento-venta" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">Argumento de Venta</a>
                <a href="#preguntas-ia" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">Preguntas a la IA</a>
                <a href="#conclusion" class="text-gray-300 hover:text-[#E8316E] font-medium transition-colors duration-200">Conclusi√≥n</a>
            </div>
            <button class="md:hidden text-gray-300 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
            </button>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-10">

        <section id="hero" class="text-center py-16 bg-gradient-to-r from-[#E8316E] to-orange-500 rounded-xl shadow-xl mb-16 text-white">
            <h1 class="text-5xl font-extrabold mb-4 drop-shadow-md">Invierta en el Futuro de la Movilidad con Lolocar</h1>
            <p class="text-2xl font-light leading-relaxed max-w-4xl mx-auto opacity-90">
                Descubra una oportunidad de inversi√≥n √∫nica en una flota de veh√≠culos conectados, listos para generar ingresos inmediatos. Con Lolocar, acceda a retornos netos anuales estimados entre 20% y 30%, superando significativamente las inversiones tradicionales.
            </p>
        </section>
        
        <div id="app-intro" class="bg-blue-50 border-l-4 border-[#415AAE] p-6 rounded-lg shadow-sm mb-12">
            <h2 class="text-2xl font-semibold text-[#050B3B] mb-3">Bienvenido al An√°lisis Interactivo de Inversi√≥n Lolocar</h2>
            <p class="text-gray-700">
                Esta aplicaci√≥n ha sido dise√±ada para ayudarle a comprender en detalle la oportunidad de inversi√≥n que Lolocar ofrece. A trav√©s de las siguientes secciones, podr√° explorar comparativas, an√°lisis financieros detallados, proyecciones de rentabilidad incluyendo la venta del veh√≠culo, y los riesgos asociados con sus respectivas mitigaciones. Nuestro objetivo es proporcionarle toda la informaci√≥n necesaria para tomar una decisi√≥n informada.
            </p>
        </div>

        <section id="puntos-clave" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                <h2 class="text-4xl font-bold text-center text-gray-800 mb-3">‚ú® Puntos Clave del Informe</h2>
                <p class="text-center text-gray-600 mb-10 text-lg">
                    Obtenga una s√≠ntesis r√°pida de los aspectos m√°s relevantes de esta oportunidad de inversi√≥n.
                </p>
                <div class="text-center">
                    <button id="generate-key-points-btn" class="bg-[#E8316E] hover:bg-rose-700 text-white font-bold py-4 px-8 rounded-lg shadow-xl transition-all duration-300 text-lg transform hover:scale-105">
                        ‚ú® Generar Puntos Clave
                    </button>
                    <div id="key-points-container" class="mt-8 bg-blue-50 p-8 rounded-lg text-gray-800 text-left hidden shadow-lg border border-[#415AAE]">
                        <h4 class="font-semibold text-[#050B3B] text-xl mb-3">Resumen del Informe (Generado por IA):</h4>
                        <div id="key-points-content" class="leading-relaxed">
                            </div>
                        <div id="key-points-loading-indicator" class="hidden text-center mt-6">
                            <div class="animate-spin inline-block w-10 h-10 border-4 border-t-4 border-[#415AAE] border-solid rounded-full"></div>
                            <p class="text-[#415AAE] mt-2 text-lg">Generando puntos clave, por favor espere...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="comparativa" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow-lg mb-8">
                <h2 class="text-4xl font-bold text-center text-gray-800 mb-3">¬øPor Qu√© Invertir en Lolocar?</h2>
                <p class="text-center text-gray-600 mb-10 text-lg">Descubra las ventajas de invertir en una flota de veh√≠culos Lolocar frente a opciones tradicionales.</p>
            </div>

            <div class="grid md:grid-cols-2 gap-10 items-start">
                <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                    <h3 class="text-2xl font-semibold text-[#E8316E] mb-5">Comparaci√≥n de Inversiones</h3>
                    <p class="text-gray-700 mb-6 leading-relaxed">La inversi√≥n en veh√≠culos Lolocar ofrece una alternativa atractiva frente a la inversi√≥n inmobiliaria tradicional, destacando por su menor barrera de entrada y mayor potencial de retorno.</p>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse min-w-[500px]">
                            <thead>
                                <tr class="bg-gray-100 text-gray-700 uppercase text-sm font-medium">
                                    <th class="p-4 border-b border-gray-200 rounded-tl-lg">Caracter√≠stica</th>
                                    <th class="p-4 border-b border-gray-200">Departamento</th>
                                    <th class="p-4 border-b border-gray-200 rounded-tr-lg">Veh√≠culo Lolocar</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hover:bg-gray-50 border-b border-gray-100 last:border-b-0">
                                    <td class="p-4 font-semibold text-gray-800">üí∞ Inversi√≥n Inicial</td>
                                    <td class="p-4">UF 5.000 (~ $180 MM CLP)</td>
                                    <td class="p-4">$6-8 MM CLP</td>
                                </tr>
                                <tr class="hover:bg-gray-50 border-b border-gray-100 last:border-b-0">
                                    <td class="p-4 font-semibold text-gray-800">üìà Retorno Anual</td>
                                    <td class="p-4">4% bruto</td>
                                    <td class="p-4 text-[#E8316E] font-bold">20-30% neto</td>
                                </tr>
                                <tr class="hover:bg-gray-50 border-b border-gray-100 last:border-b-0">
                                    <td class="p-4 font-semibold text-gray-800">üíß Liquidez</td>
                                    <td class="p-4">Baja (venta lenta)</td>
                                    <td class="p-4 text-[#415AAE] font-bold">Alta (venta r√°pida)</td>
                                </tr>
                                <tr class="hover:bg-gray-50 border-b border-gray-100 last:border-b-0">
                                    <td class="p-4 font-semibold text-gray-800">‚ö° Generaci√≥n de Ingresos</td>
                                    <td class="p-4">1-2 meses (b√∫squeda arrendatario)</td>
                                    <td class="p-4 text-[#415AAE] font-bold">Inmediata</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="p-4 font-semibold text-gray-800">üõ†Ô∏è Costos Operativos</td>
                                    <td class="p-4">Mantenci√≥n, contribuciones</td>
                                    <td class="p-4">Seguro, SOAP, mantenci√≥n, tecnolog√≠a</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                    <h3 class="text-2xl font-semibold text-[#E8316E] mb-5">Ventajas Clave de Lolocar</h3>
                     <p class="text-gray-700 mb-6 leading-relaxed">Lolocar simplifica la inversi√≥n y maximiza su rentabilidad a trav√©s de un modelo de negocio eficiente y probado.</p>
                    <ul class="space-y-4 text-gray-700">
                        <li class="flex items-start"><span class="text-[#E8316E] mr-3 text-2xl">‚úî</span> <strong>Baja barrera de entrada:</strong> Inversi√≥n hasta 30 veces menor que un departamento.</li>
                        <li class="flex items-start"><span class="text-[#E8316E] mr-3 text-2xl">‚úî</span> <strong>Alta rentabilidad:</strong> Retornos netos hasta 7 veces superiores.</li>
                        <li class="flex items-start"><span class="text-[#E8316E] mr-3 text-2xl">‚úî</span> <strong>Ingresos inmediatos:</strong> Los veh√≠culos generan flujo de caja al integrarse a la plataforma.</li>
                        <li class="flex items-start"><span class="text-[#E8316E] mr-3 text-2xl">‚úî</span> <strong>Gesti√≥n simplificada:</strong> Lolocar administra todos los costos operativos (seguro, mantenci√≥n, tecnolog√≠a sin llaves).</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="analisis" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                <h2 class="text-4xl font-bold text-center text-gray-800 mb-3">An√°lisis Financiero Interactivo</h2>
                <p class="text-center text-gray-600 mb-10 text-lg">Explore el Valor Actual Neto (VAN) y la Tasa Interna de Retorno (TIR) bajo diferentes escenarios de descuento. Estos c√°lculos consideran todos los costos operativos reales para ofrecer una visi√≥n transparente de la rentabilidad potencial.</p>
                
                <div class="flex justify-center space-x-6 mb-10">
                    <button id="btn-discount-5" class="tab-button py-3 px-6 rounded-lg font-semibold text-lg transition-colors duration-150 active shadow-md hover:shadow-lg">Descuento 5%</button>
                    <button id="btn-discount-10" class="tab-button py-3 px-6 rounded-lg font-semibold text-lg transition-colors duration-150 shadow-md hover:shadow-lg">Descuento 10%</button>
                </div>

                <div class="grid md:grid-cols-2 gap-10 mb-10">
                    <div>
                        <h3 class="text-2xl font-semibold text-center text-gray-700 mb-4">Valor Actual Neto (VAN) en CLP</h3>
                        <div class="chart-container bg-gray-50 p-6 rounded-lg shadow-inner">
                            <canvas id="vanChart"></canvas>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-2xl font-semibold text-center text-gray-700 mb-4">Tasa Interna de Retorno (TIR) en %</h3>
                        <div class="chart-container bg-gray-50 p-6 rounded-lg shadow-inner">
                            <canvas id="tirChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-2xl font-semibold text-gray-700 mb-4">Observaciones Clave:</h3>
                    <div id="financial-observations" class="text-gray-700 space-y-3 bg-blue-50 border-l-4 border-[#415AAE] p-5 rounded-lg shadow-sm">
                        </div>
                </div>

                <div class="mt-12 text-center">
                    <button id="generate-insight-btn" class="bg-[#E8316E] hover:bg-rose-700 text-white font-bold py-4 px-8 rounded-lg shadow-xl transition-all duration-300 text-lg transform hover:scale-105">
                        ‚ú® Generar An√°lisis R√°pido con IA
                    </button>
                    <div id="llm-insight-container" class="mt-8 bg-amber-50 p-8 rounded-lg text-gray-800 text-left hidden shadow-lg border border-amber-200">
                        <h4 class="font-semibold text-amber-800 text-xl mb-3">An√°lisis Generado por IA:</h4>
                        <div id="llm-insight-content" class="leading-relaxed">
                            </div>
                        <div id="llm-loading-indicator" class="hidden text-center mt-6">
                            <div class="animate-spin inline-block w-10 h-10 border-4 border-t-4 border-amber-600 border-solid rounded-full"></div>
                            <p class="text-amber-700 mt-2 text-lg">Generando an√°lisis, por favor espere...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="rentabilidad-venta" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                <h2 class="text-4xl font-bold text-center text-gray-800 mb-3">Rentabilidad Adicional por Venta del Veh√≠culo</h2>
                <p class="text-center text-gray-600 mb-10 text-lg">
                    Adem√°s de los ingresos por arriendo, la venta del veh√≠culo al final del per√≠odo de inversi√≥n representa un ingreso adicional. A continuaci√≥n, se proyecta este valor considerando una depreciaci√≥n anual conservadora.
                </p>

                <div class="grid md:grid-cols-2 gap-10 items-center">
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-2xl font-semibold text-[#E8316E] mb-4">Supuestos para el C√°lculo:</h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700 pl-4 mb-4">
                            <li><strong>Inversi√≥n Inicial Promedio Veh√≠culo:</strong> <span class="font-bold text-gray-900">$7,000,000 CLP</span></li>
                            <li><strong>Tasa de Depreciaci√≥n Anual:</strong> <span class="font-bold text-gray-900">3%</span> sobre el valor inicial</li>
                        </ul>
                        <p class="text-gray-600 leading-relaxed">
                            Estos supuestos permiten estimar el valor de reventa del activo, que se suma a la rentabilidad operativa.
                        </p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-2xl font-semibold text-[#E8316E] mb-4">C√°lculo del Valor Residual Estimado:</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-collapse">
                                <thead>
                                    <tr class="bg-gray-100 text-gray-700 uppercase text-sm font-medium">
                                        <th class="p-4 border-b border-gray-200">Per√≠odo</th>
                                        <th class="p-4 border-b border-gray-200">Valor Residual Estimado (CLP)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="hover:bg-gray-100 border-b border-gray-200">
                                        <td class="p-4 text-gray-800">Al final del A√±o 2</td>
                                        <td id="residual-y2" class="p-4 font-bold text-gray-900">$6,586,300</td>
                                    </tr>
                                    <tr class="hover:bg-gray-100 border-b border-gray-200">
                                        <td class="p-4 text-gray-800">Al final del A√±o 3</td>
                                        <td id="residual-y3" class="p-4 font-bold text-gray-900">$6,388,711</td>
                                    </tr>
                                    <tr class="hover:bg-gray-100">
                                        <td class="p-4 text-gray-800">Al final del A√±o 4</td>
                                        <td id="residual-y4" class="p-4 font-bold text-gray-900">$6,197,040</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="mt-10 bg-blue-50 border-l-4 border-[#415AAE] p-6 rounded-lg shadow-sm">
                    <h3 class="text-2xl font-semibold text-[#050B3B] mb-4">Impacto en la Rentabilidad General:</h3>
                    <p class="text-gray-700 leading-relaxed">
                        La inclusi√≥n de este valor residual de venta al final del per√≠odo de inversi√≥n tiene un impacto positivo significativo en la rentabilidad total. Los valores de VAN y TIR, ya de por s√≠ atractivos como se muestra en el an√°lisis financiero, se ver√°n potenciados por este ingreso adicional. Este factor convierte la inversi√≥n en un activo a√∫n m√°s l√≠quido y con un potencial de retorno total superior, reforzando la solidez y el atractivo de la inversi√≥n en la flota de Lolocar.
                    </p>
                </div>
            </div>
        </section>

        <section id="analisis-personalizado" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                <h2 class="text-4xl font-bold text-center text-gray-800 mb-3">‚ú® An√°lisis de Escenario Personalizado</h2>
                <p class="text-center text-gray-600 mb-10 text-lg">
                    Ingrese sus propios par√°metros de inversi√≥n para obtener un an√°lisis de viabilidad personalizado, basado en los datos del informe.
                </p>

                <div class="max-w-2xl mx-auto space-y-6">
                    <div>
                        <label for="investment-amount" class="block text-gray-700 text-lg font-medium mb-2">Monto de Inversi√≥n Deseado (CLP):</label>
                        <input type="number" id="investment-amount" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E8316E] focus:border-transparent transition-all duration-200" placeholder="Ej: 7000000">
                    </div>
                    <div>
                        <label for="investment-period" class="block text-gray-700 text-lg font-medium mb-2">Per√≠odo de Inversi√≥n (A√±os):</label>
                        <input type="number" id="investment-period" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E8316E] focus:border-transparent transition-all duration-200" placeholder="Ej: 3">
                    </div>
                    <div>
                        <label for="expected-return" class="block text-gray-700 text-lg font-medium mb-2">Retorno Anual Esperado (%):</label>
                        <input type="number" id="expected-return" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E8316E] focus:border-transparent transition-all duration-200" placeholder="Ej: 25">
                    </div>

                    <button id="analyze-scenario-btn" class="mt-6 w-full bg-[#E8316E] hover:bg-rose-700 text-white font-bold py-4 px-8 rounded-lg shadow-xl transition-all duration-300 text-lg transform hover:scale-105">
                        Analizar Escenario
                    </button>

                    <div id="scenario-analysis-container" class="mt-8 bg-blue-50 p-6 rounded-lg text-gray-800 text-left hidden shadow-lg border border-[#415AAE]">
                        <h4 class="font-semibold text-[#050B3B] text-xl mb-3">An√°lisis de Escenario (Generado por IA):</h4>
                        <div id="scenario-analysis-content" class="leading-relaxed">
                            </div>
                        <div id="scenario-loading-indicator" class="hidden text-center mt-6">
                            <div class="animate-spin inline-block w-10 h-10 border-4 border-t-4 border-[#415AAE] border-solid rounded-full"></div>
                            <p class="text-[#415AAE] mt-2 text-lg">Analizando escenario, por favor espere...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="riesgos" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                <h2 class="text-4xl font-bold text-center text-gray-800 mb-3">Riesgos y Mitigaciones</h2>
                <p class="text-center text-gray-600 mb-10 text-lg">Entendemos que toda inversi√≥n conlleva riesgos. En Lolocar, hemos identificado los principales y establecido estrategias efectivas para mitigarlos, protegiendo su inversi√≥n.</p>
                <div class="space-y-8">
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200">
                        <h4 class="font-bold text-[#E8316E] text-xl mb-2 flex items-center">
                            <span class="text-2xl mr-3">üõ°Ô∏è</span> Riesgo de da√±o o robo del veh√≠culo:
                        </h4>
                        <p class="text-gray-700 leading-relaxed pl-8">Todos los veh√≠culos cuentan con seguros integrales incluidos en los costos operativos, minimizando el impacto financiero ante cualquier siniestro.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200">
                        <h4 class="font-bold text-[#E8316E] text-xl mb-2 flex items-center">
                            <span class="text-2xl mr-3">üìà</span> Fluctuaciones en la demanda de car-sharing:
                        </h4>
                        <p class="text-gray-700 leading-relaxed pl-8">Lolocar opera en mercados de alta demanda demostrada y utiliza algoritmos avanzados para optimizar la asignaci√≥n de veh√≠culos, asegurando una alta tasa de utilizaci√≥n.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200">
                        <h4 class="font-bold text-[#E8316E] text-xl mb-2 flex items-center">
                            <span class="text-2xl mr-3">üìâ</span> Depreciaci√≥n acelerada del veh√≠culo:
                        </h4>
                        <p class="text-gray-700 leading-relaxed pl-8">La alta rotaci√≥n de la flota, sumada a un riguroso programa de mantenimiento profesional, ayuda a minimizar el impacto de la depreciaci√≥n y a mantener un buen valor residual de los veh√≠culos.</p>
                    </div>
                </div>

                <div class="mt-12 max-w-2xl mx-auto bg-white text-gray-800 p-8 rounded-lg shadow-lg border border-gray-100">
                    <h3 class="text-2xl font-semibold text-[#E8316E] mb-5">‚ú® Asistente de Evaluaci√≥n de Riesgos</h3>
                    <p class="text-gray-700 mb-6">
                        Ingrese un riesgo espec√≠fico que le preocupe y la IA le proporcionar√° informaci√≥n sobre c√≥mo Lolocar lo mitiga, bas√°ndose en el informe.
                    </p>
                    <textarea id="risk-question-input" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E8316E] focus:border-transparent transition-all duration-200 resize-y min-h-[100px]" placeholder="Ej: ¬øQu√© pasa si el veh√≠culo sufre un accidente?" rows="4"></textarea>
                    <button id="evaluate-risk-btn" class="mt-4 w-full bg-[#415AAE] hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors duration-200 transform hover:scale-105">
                        Evaluar Riesgo
                    </button>
                    <div id="risk-evaluation-container" class="mt-8 bg-blue-50 p-6 rounded-lg text-gray-800 text-left hidden shadow-lg border border-[#415AAE]">
                        <h4 class="font-semibold text-[#050B3B] text-xl mb-3">Respuesta de la IA sobre el Riesgo:</h4>
                        <div id="risk-evaluation-content" class="leading-relaxed">
                            </div>
                        <div id="risk-loading-indicator" class="hidden text-center mt-6">
                            <div class="animate-spin inline-block w-10 h-10 border-4 border-t-4 border-[#415AAE] border-solid rounded-full"></div>
                            <p class="text-[#415AAE] mt-2 text-lg">Evaluando riesgo, por favor espere...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="argumento-venta" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                <h2 class="text-4xl font-bold text-center text-gray-800 mb-3">‚ú® Generador de Argumentos de Venta</h2>
                <p class="text-center text-gray-600 mb-10 text-lg">
                    Cree un argumento de venta persuasivo para presentar la oportunidad de inversi√≥n en Lolocar, adaptado a su p√∫blico o enfoque.
                </p>

                <div class="max-w-2xl mx-auto">
                    <textarea id="sales-pitch-input" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E8316E] focus:border-transparent transition-all duration-200 resize-y min-h-[120px]" placeholder="Ej: Argumento para inversores que buscan diversificaci√≥n y altos retornos." rows="6"></textarea>
                    <button id="generate-sales-pitch-btn" class="mt-4 w-full bg-[#E8316E] hover:bg-rose-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors duration-200 transform hover:scale-105">
                        Generar Argumento de Venta
                    </button>
                    <div id="sales-pitch-output-container" class="mt-8 bg-amber-50 p-6 rounded-lg text-gray-800 text-left hidden shadow-lg border border-amber-200">
                        <h4 class="font-semibold text-amber-800 text-xl mb-3">Argumento de Venta (Generado por IA):</h4>
                        <div id="sales-pitch-output-content" class="leading-relaxed">
                            </div>
                        <div id="sales-pitch-loading-indicator" class="hidden text-center mt-6">
                            <div class="animate-spin inline-block w-10 h-10 border-4 border-t-4 border-amber-600 border-solid rounded-full"></div>
                            <p class="text-amber-700 mt-2 text-lg">Generando argumento, por favor espere...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="preguntas-ia" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-100">
                <h2 class="text-4xl font-bold text-center text-gray-800 mb-3">‚ú® Preguntas a la IA sobre el Informe</h2>
                <p class="text-center text-gray-600 mb-10 text-lg">
                    ¬øTiene alguna pregunta espec√≠fica sobre la oportunidad de inversi√≥n en Lolocar? Escriba su consulta a continuaci√≥n y nuestra IA le proporcionar√° una respuesta basada en el contenido de este informe.
                </p>

                <div class="max-w-2xl mx-auto">
                    <textarea id="user-question-input" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E8316E] focus:border-transparent transition-all duration-200 resize-y min-h-[100px]" placeholder="Ej: ¬øCu√°les son los principales riesgos de esta inversi√≥n?" rows="4"></textarea>
                    <button id="ask-ai-btn" class="mt-4 w-full bg-[#415AAE] hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors duration-200 transform hover:scale-105">
                        Preguntar a la IA
                    </button>

                    <div id="ai-answer-container" class="mt-8 bg-blue-50 p-6 rounded-lg text-gray-800 text-left hidden shadow-lg border border-[#415AAE]">
                        <h4 class="font-semibold text-[#050B3B] text-xl mb-3">Respuesta de la IA:</h4>
                        <div id="ai-answer-content" class="leading-relaxed">
                            </div>
                        <div id="ai-loading-indicator" class="hidden text-center mt-6">
                            <div class="animate-spin inline-block w-10 h-10 border-4 border-t-4 border-[#415AAE] border-solid rounded-full"></div>
                            <p class="text-[#415AAE] mt-2 text-lg">Generando respuesta, por favor espere...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="conclusion" class="py-12 text-center">
             <div class="bg-[#E8316E] p-10 rounded-xl shadow-xl text-white">
                <h2 class="text-4xl font-extrabold mb-5 drop-shadow-md">Una Oportunidad Excepcional le Espera</h2>
                 <p class="text-xl font-light leading-relaxed mb-8 max-w-4xl mx-auto opacity-95">
                    Invertir en la flota de Lolocar representa una alternativa innovadora y altamente rentable frente a las inversiones tradicionales. Con un retorno neto potencial de hasta 30% anual, una inversi√≥n inicial accesible y la gesti√≥n integral por parte de Lolocar, esta es su oportunidad para diversificar su portafolio y generar ingresos inmediatos y sostenibles.
                </p>
                <p class="text-xl font-medium mb-10">
                    ¬°No deje pasar la oportunidad de unirse a la revoluci√≥n del car-sharing! Los veh√≠culos de la liquidaci√≥n de Awto est√°n disponibles por tiempo limitado.
                </p>
                <a href="mailto:inversiones@lolocar.com?subject=Consulta%20Inversi√≥n%20Lolocar" class="bg-white text-[#E8316E] font-bold py-4 px-10 rounded-lg hover:bg-gray-100 transition-colors text-xl shadow-lg transform hover:scale-105 inline-block">
                    Contacte para un Plan Personalizado
                </a>

                <div class="mt-12 max-w-3xl mx-auto bg-white text-gray-800 p-8 rounded-lg shadow-lg border border-gray-100">
                    <h3 class="text-2xl font-semibold text-[#E8316E] mb-5">‚ú® Generar Invitaci√≥n Personalizada</h3>
                    <p class="text-gray-700 mb-6">
                        Utilice la IA para redactar un borrador de invitaci√≥n o mensaje sobre esta oportunidad.
                    </p>
                    <textarea id="invitation-input" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E8316E] focus:border-transparent transition-all duration-200 resize-y min-h-[120px]" placeholder="Ej: Redacta un email para un inversor interesado en rentabilidad a largo plazo y bajo riesgo." rows="6"></textarea>
                    <button id="generate-invitation-btn" class="mt-4 w-full bg-[#415AAE] hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors duration-200 transform hover:scale-105">
                        Generar Invitaci√≥n
                    </button>
                    <div id="invitation-output-container" class="mt-8 bg-blue-50 p-6 rounded-lg text-gray-800 text-left hidden shadow-lg border border-[#415AAE]">
                        <h4 class="font-semibold text-[#050B3B] text-xl mb-3">Borrador de Invitaci√≥n (Generado por IA):</h4>
                        <div id="invitation-output-content" class="leading-relaxed whitespace-pre-wrap">
                            </div>
                        <div id="invitation-loading-indicator" class="hidden text-center mt-6">
                            <div class="animate-spin inline-block w-10 h-10 border-4 border-t-4 border-[#415AAE] border-solid rounded-full"></div>
                            <p class="text-[#415AAE] mt-2 text-lg">Generando invitaci√≥n, por favor espere...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-[#050B3B] text-gray-300 text-center py-6">
        <p>&copy; 2025 Lolocar Inversiones. Todos los derechos reservados.</p>
        <p class="text-sm text-gray-500 mt-1">Fecha del informe original: 24 de Mayo, 2025</p>
    </footer>

    <script>
        const financialData = {
            '5': {
                van: {
                    labels: ['2 A√±os', '3 A√±os', '4 A√±os'],
                    datasets: [
                        { label: 'Veh√≠culo Lolocar', data: [-149611, 2753468, 5392632], backgroundColor: 'rgba(232, 49, 110, 0.8)', borderColor: 'rgba(232, 49, 110, 1)', borderWidth: 1 } // Lolocar Pink
                    ]
                },
                tir: {
                    labels: ['2 A√±os', '3 A√±os'],
                    datasets: [
                        { label: 'Veh√≠culo Lolocar', data: [8.4, 31.8], backgroundColor: 'rgba(65, 90, 174, 0.8)', borderColor: 'rgba(65, 90, 174, 1)', borderWidth: 1 } // Lolocar Light Blue
                    ]
                },
                observations: [
                    "El VAN negativo en el escenario de 2 a√±os con descuento del 5% refleja el per√≠odo inicial de recuperaci√≥n de la inversi√≥n.",
                    "A partir del tercer a√±o, el VAN crece significativamente, alcanzando valores superiores a $5 MM CLP en 4 a√±os.",
                    "La TIR supera el 30% en 3 a√±os. Para 4 a√±os, se espera que la TIR supere el 40%, demostrando una rentabilidad excepcional (dato seg√∫n texto del informe)."
                ]
            },
            '10': {
                van: {
                    labels: ['2 A√±os', '3 A√±os', '4 A√±os'],
                    datasets: [
                        { label: 'Veh√≠culo Lolocar', data: [207388, 3110468, 5749632], backgroundColor: 'rgba(232, 49, 110, 0.8)', borderColor: 'rgba(232, 49, 110, 1)', borderWidth: 1 } // Lolocar Pink
                    ]
                },
                tir: {
                    labels: ['2 A√±os', '3 A√±os'],
                    datasets: [
                        { label: 'Veh√≠culo Lolocar', data: [12.4, 35.8], backgroundColor: 'rgba(65, 90, 174, 0.8)', borderColor: 'rgba(65, 90, 174, 1)', borderWidth: 1 } // Lolocar Light Blue
                    ]
                },
                observations: [
                    "Con una tasa de descuento del 10%, el VAN es positivo desde el segundo a√±o.",
                    "El VAN a 4 a√±os supera los $5.7 MM CLP, mostrando una s√≥lida rentabilidad incluso con una tasa de descuento m√°s exigente.",
                    "La TIR se mantiene robusta, superando el 35% en 3 a√±os. Para 4 a√±os, se espera que la TIR supere el 40% (dato seg√∫n texto del informe)."
                ]
            }
        };

        let vanChartInstance, tirChartInstance;
        const vanCtx = document.getElementById('vanChart').getContext('2d');
        const tirCtx = document.getElementById('tirChart').getContext('2d');
        const observationsDiv = document.getElementById('financial-observations');
        
        const btnDiscount5 = document.getElementById('btn-discount-5');
        const btnDiscount10 = document.getElementById('btn-discount-10');
        const generateInsightBtn = document.getElementById('generate-insight-btn');
        const llmInsightContainer = document.getElementById('llm-insight-container');
        const llmInsightContent = document.getElementById('llm-insight-content');
        const llmLoadingIndicator = document.getElementById('llm-loading-indicator');

        const userQuestionInput = document.getElementById('user-question-input');
        const askAiBtn = document.getElementById('ask-ai-btn');
        const aiAnswerContainer = document.getElementById('ai-answer-container');
        const aiAnswerContent = document.getElementById('ai-answer-content');
        const aiLoadingIndicator = document.getElementById('ai-loading-indicator');

        const generateKeyPointsBtn = document.getElementById('generate-key-points-btn');
        const keyPointsContainer = document.getElementById('key-points-container');
        const keyPointsContent = document.getElementById('key-points-content');
        const keyPointsLoadingIndicator = document.getElementById('key-points-loading-indicator');

        const investmentAmountInput = document.getElementById('investment-amount');
        const investmentPeriodInput = document.getElementById('investment-period');
        const expectedReturnInput = document.getElementById('expected-return');
        const analyzeScenarioBtn = document.getElementById('analyze-scenario-btn');
        const scenarioAnalysisContainer = document.getElementById('scenario-analysis-container');
        const scenarioAnalysisContent = document.getElementById('scenario-analysis-content');
        const scenarioLoadingIndicator = document.getElementById('scenario-loading-indicator');

        const riskQuestionInput = document.getElementById('risk-question-input');
        const evaluateRiskBtn = document.getElementById('evaluate-risk-btn');
        const riskEvaluationContainer = document.getElementById('risk-evaluation-container');
        const riskEvaluationContent = document.getElementById('risk-evaluation-content');
        const riskLoadingIndicator = document.getElementById('risk-loading-indicator');

        const salesPitchInput = document.getElementById('sales-pitch-input');
        const generateSalesPitchBtn = document.getElementById('generate-sales-pitch-btn');
        const salesPitchOutputContainer = document.getElementById('sales-pitch-output-container');
        const salesPitchOutputContent = document.getElementById('sales-pitch-output-content');
        const salesPitchLoadingIndicator = document.getElementById('sales-pitch-loading-indicator');

        const invitationInput = document.getElementById('invitation-input');
        const generateInvitationBtn = document.getElementById('generate-invitation-btn');
        const invitationOutputContainer = document.getElementById('invitation-output-container');
        const invitationOutputContent = document.getElementById('invitation-output-content');
        const invitationLoadingIndicator = document.getElementById('invitation-loading-indicator');


        let currentDiscountRate = '5'; // Default

        function createChart(ctx, type, data, options) {
            return new Chart(ctx, { type, data, options });
        }

        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: { 
                    beginAtZero: false,
                    ticks: {
                        callback: function(value, index, values) {
                            if (Math.abs(value) >= 1000000) {
                                return (value / 1000000).toLocaleString('es-CL', { maximumFractionDigits: 1 }) + 'M';
                            }
                            return value.toLocaleString('es-CL');
                        }
                    },
                    grid: {
                        color: 'rgba(200, 200, 200, 0.2)'
                    }
                },
                x: {
                    grid: {
                        color: 'rgba(200, 200, 200, 0.2)'
                    }
                }
            },
            plugins: {
                legend: {
                    display: false // Only one dataset label, remove legend for cleaner look
                },
                tooltip: {
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    titleColor: '#fff',
                    bodyColor: '#fff',
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                if (context.chart.canvas.id === 'tirChart') {
                                   label += context.parsed.y.toLocaleString('es-CL', { style: 'percent', minimumFractionDigits: 1 });
                                } else {
                                   label += '$' + context.parsed.y.toLocaleString('es-CL');
                                }
                            }
                            return label;
                        }
                    }
                }
            }
        };
        
        const tirChartOptions = JSON.parse(JSON.stringify(chartOptions)); // Deep copy
        tirChartOptions.scales.y.ticks.callback = function(value, index, values) {
            return value.toLocaleString('es-CL') + '%';
        };


        function updateCharts(discountRate) {
            currentDiscountRate = discountRate; // Update current discount rate
            const data = financialData[discountRate];
            
            if (vanChartInstance) vanChartInstance.destroy();
            vanChartInstance = createChart(vanCtx, 'bar', data.van, chartOptions);

            if (tirChartInstance) tirChartInstance.destroy();
            tirChartInstance = createChart(tirCtx, 'bar', data.tir, tirChartOptions);
            
            observationsDiv.innerHTML = data.observations.map(obs => `<p class="flex items-start"><span class="text-[#415AAE] mr-2 text-lg">üí°</span>${obs}</p>`).join('');
        }
        
        btnDiscount5.addEventListener('click', () => {
            updateCharts('5');
            btnDiscount5.classList.add('active');
            btnDiscount10.classList.remove('active');
            llmInsightContainer.classList.add('hidden'); // Hide insight when changing discount rate
        });

        btnDiscount10.addEventListener('click', () => {
            updateCharts('10');
            btnDiscount10.classList.add('active');
            btnDiscount5.classList.remove('active');
            llmInsightContainer.classList.add('hidden'); // Hide insight when changing discount rate
        });

        // Full Report Context for LLM interactions
        const fullReportContext = `
            Contexto del Informe de Inversi√≥n Lolocar:
            - Resumen Ejecutivo: Lolocar ofrece inversi√≥n en flota de veh√≠culos conectados para car-sharing. Retorno neto anual 20-30% vs. 4% bruto para departamentos. Inversi√≥n inicial $6-8 MM CLP por veh√≠culo. Activo l√≠quido, bajo costo, alta rentabilidad.
            - Comparaci√≥n de Inversiones:
                - Inversi√≥n Inicial: Depto UF 5.000 (~$180 MM CLP), Veh√≠culo $6-8 MM CLP.
                - Retorno Anual: Depto 4% bruto, Veh√≠culo 20-30% neto.
                - Liquidez: Depto Baja, Veh√≠culo Alta.
                - Generaci√≥n de Ingresos: Depto 1-2 meses, Veh√≠culo Inmediata.
                - Costos Operativos: Depto Mantenci√≥n/Contribuciones, Veh√≠culo Seguro/SOAP/Mantenci√≥n/Tecnolog√≠a.
            - Ventajas Clave: Baja barrera de entrada (30x menor), alta rentabilidad (7x superior), ingresos inmediatos, gesti√≥n simplificada por Lolocar.
            - An√°lisis Financiero (VAN y TIR):
                - Descuento 5%: VAN (2a) -149,611, VAN (3a) 2,753,468, VAN (4a) 5,392,632. TIR (2a) 8.4%, TIR (3a) 31.8%. Observaciones: VAN negativo en 2 a√±os (recuperaci√≥n inicial), crece a >$5MM en 4 a√±os. TIR >30% en 3 a√±os, >40% en 4 a√±os.
                - Descuento 10%: VAN (2a) 207,388, VAN (3a) 3,110,468, VAN (4a) 5,749,632. TIR (2a) 12.4%, TIR (3a) 35.8%. Observaciones: VAN positivo desde 2do a√±o, >$5.7MM en 4 a√±os. TIR >35% en 3 a√±os, >40% en 4 a√±os.
            - Rentabilidad con Venta y Depreciaci√≥n: Inversi√≥n inicial promedio $7,000,000 CLP. Depreciaci√≥n anual 3%.
                - Valor Residual A√±o 2: $6,586,300 CLP
                - Valor Residual A√±o 3: $6,388,711 CLP
                - Valor Residual A√±o 4: $6,197,040 CLP
                - Impacto: Aumenta la rentabilidad total, hace la inversi√≥n m√°s l√≠quida.
            - Riesgos y Mitigaciones:
                - Da√±o/Robo: Todos los veh√≠culos cuentan con seguros integrales incluidos en los costos operativos.
                - Fluctuaciones demanda: Lolocar opera en mercados de alta demanda y optimiza la asignaci√≥n de veh√≠culos mediante algoritmos.
                - Depreciaci√≥n: La alta rotaci√≥n y mantenimiento profesional minimizan el impacto de la depreciaci√≥n.
        `;

        // Function to call Gemini API
        async function callGeminiAPI(promptText, outputElement, loadingIndicator) {
            outputElement.innerHTML = '';
            loadingIndicator.classList.remove('hidden');

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: promptText }] });
            const payload = { contents: chatHistory };
            
            // ¬°ADVERTENCIA DE SEGURIDAD!: Para entornos de producci√≥n, es ALTAMENTE RECOMENDABLE
            // usar variables de entorno en Vercel (o tu proveedor de hosting) para no exponer tu clave en el c√≥digo.
            // Por ejemplo, si usas Vercel, configurar√≠as una variable de entorno llamada GEMINI_API_KEY
            // y la acceder√≠as aqu√≠ con: const apiKey = process.env.GEMINI_API_KEY;
            const apiKey = ""; // ¬°La clave de API ha sido eliminada de aqu√≠!
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    outputElement.textContent = text;
                } else {
                    outputElement.textContent = 'No se pudo generar la respuesta. Intente de nuevo.';
                    console.error('Unexpected API response structure:', result);
                }
            } catch (error) {
                outputElement.textContent = 'Error al conectar con la IA. Por favor, intente m√°s tarde.';
                console.error('Error fetching from Gemini API:', error);
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        // LLM Integration for "An√°lisis R√°pido"
        generateInsightBtn.addEventListener('click', async () => {
            llmInsightContainer.classList.remove('hidden');
            const currentData = financialData[currentDiscountRate];
            const vanData = currentData.van.datasets[0].data;
            const tirData = currentData.tir.datasets[0].data;
            const observations = currentData.observations.join(' ');

            const prompt = `Genera un an√°lisis conciso de la oportunidad de inversi√≥n en Lolocar basado en los siguientes datos financieros y observaciones. La tasa de descuento actual es del ${currentDiscountRate}%.
            VAN (Valor Actual Neto) para 2, 3 y 4 a√±os: ${vanData.map(v => v.toLocaleString('es-CL')).join(', ')} CLP.
            TIR (Tasa Interna de Retorno) para 2 y 3 a√±os: ${tirData.map(t => t.toLocaleString('es-CL') + '%').join(', ')}.
            Observaciones clave: ${observations}
            
            Destaca los puntos m√°s importantes sobre la rentabilidad y el riesgo. Limita la respuesta a un p√°rrafo corto y directo.`;
            
            await callGeminiAPI(prompt, llmInsightContent, llmLoadingIndicator);
        });

        // LLM Integration for "Preguntas a la IA"
        askAiBtn.addEventListener('click', async () => {
            const userQuestion = userQuestionInput.value.trim();
            if (!userQuestion) {
                aiAnswerContent.textContent = 'Por favor, ingrese su pregunta.';
                aiAnswerContainer.classList.remove('hidden');
                return;
            }
            aiAnswerContainer.classList.remove('hidden');

            const prompt = `Basado √öNICAMENTE en el siguiente contexto del informe de inversi√≥n de Lolocar, responde a la pregunta del usuario. Si la informaci√≥n para responder no est√° expl√≠citamente en el contexto, indica que no puedes responderla con la informaci√≥n disponible.

            Contexto:
            ${fullReportContext}

            Pregunta del usuario: ${userQuestion}`;

            await callGeminiAPI(prompt, aiAnswerContent, aiLoadingIndicator);
        });

        // LLM Integration for "Puntos Clave del Informe"
        generateKeyPointsBtn.addEventListener('click', async () => {
            keyPointsContainer.classList.remove('hidden');
            const prompt = `Genera una lista de 3 a 5 puntos clave o un resumen muy conciso del siguiente informe de inversi√≥n de Lolocar. Enf√≥cate en la propuesta de valor, rentabilidad y riesgos principales.

            Informe:
            ${fullReportContext}`;

            await callGeminiAPI(prompt, keyPointsContent, keyPointsLoadingIndicator);
        });

        // LLM Integration for "An√°lisis de Escenario Personalizado"
        analyzeScenarioBtn.addEventListener('click', async () => {
            scenarioAnalysisContainer.classList.remove('hidden');
            const investmentAmount = investmentAmountInput.value.trim();
            const investmentPeriod = investmentPeriodInput.value.trim();
            const expectedReturn = expectedReturnInput.value.trim();

            if (!investmentAmount || !investmentPeriod || !expectedReturn) {
                scenarioAnalysisContent.textContent = 'Por favor, complete todos los campos para el an√°lisis de escenario.';
                scenarioLoadingIndicator.classList.add('hidden');
                return;
            }

            const prompt = `Basado en el siguiente informe de inversi√≥n de Lolocar, eval√∫a la viabilidad de un escenario de inversi√≥n con los siguientes par√°metros:
            - Monto de Inversi√≥n Deseado: ${investmentAmount} CLP
            - Per√≠odo de Inversi√≥n: ${investmentPeriod} a√±os
            - Retorno Anual Esperado: ${expectedReturn}%

            Contexto del Informe:
            ${fullReportContext}

            Considera la informaci√≥n sobre VAN, TIR, retornos anuales de Lolocar (20-30% neto), y depreciaci√≥n. Proporciona un an√°lisis conciso sobre si este escenario es realista o ambicioso, y por qu√©, bas√°ndote estrictamente en los datos proporcionados en el informe.`;

            await callGeminiAPI(prompt, scenarioAnalysisContent, scenarioLoadingIndicator);
        });

        // LLM Integration for "Asistente de Evaluaci√≥n de Riesgos"
        evaluateRiskBtn.addEventListener('click', async () => {
            riskEvaluationContainer.classList.remove('hidden');
            const riskQuestion = riskQuestionInput.value.trim();

            if (!riskQuestion) {
                riskEvaluationContent.textContent = 'Por favor, ingrese el riesgo que desea evaluar.';
                riskLoadingIndicator.classList.add('hidden');
                return;
            }

            const prompt = `Basado √öNICAMENTE en la secci√≥n de "Riesgos y Mitigaciones" del siguiente informe de Lolocar, responde a la pregunta del usuario sobre un riesgo espec√≠fico. Si la informaci√≥n para responder no est√° expl√≠citamente en esa secci√≥n, indica que no puedes responderla con la informaci√≥n disponible.

            Secci√≥n de Riesgos y Mitigaciones del Informe:
            - Riesgo de da√±o o robo: Todos los veh√≠culos cuentan con seguros integrales incluidos en los costos operativos.
            - Fluctuaciones en la demanda: Lolocar opera en mercados de alta demanda y optimiza la asignaci√≥n de veh√≠culos mediante algoritmos.
            - Depreciaci√≥n del veh√≠culo: La alta rotaci√≥n y mantenimiento profesional minimizan el impacto de la depreciaci√≥n.

            Pregunta del usuario sobre un riesgo: ${riskQuestion}`;

            await callGeminiAPI(prompt, riskEvaluationContent, riskLoadingIndicator);
        });

        // LLM Integration for "Generador de Argumentos de Venta"
        generateSalesPitchBtn.addEventListener('click', async () => {
            salesPitchOutputContainer.classList.remove('hidden');
            const salesPitchContext = salesPitchInput.value.trim();

            if (!salesPitchContext) {
                salesPitchOutputContent.textContent = 'Por favor, describa el p√∫blico o enfoque para el argumento de venta.';
                salesPitchLoadingIndicator.classList.add('hidden');
                return;
            }

            const prompt = `Basado en el contexto del informe de inversi√≥n de Lolocar, genera un argumento de venta persuasivo. Considera el siguiente enfoque o p√∫blico objetivo: "${salesPitchContext}". El argumento debe ser conciso, destacar la rentabilidad, la innovaci√≥n y la gesti√≥n simplificada de Lolocar. Formato: Un p√°rrafo corto de introducci√≥n, 2-3 puntos clave en bullet points (usando guiones), y una frase final de llamado a la acci√≥n.

            Informe de Inversi√≥n Lolocar:
            ${fullReportContext}`;

            await callGeminiAPI(prompt, salesPitchOutputContent, salesPitchLoadingIndicator);
        });


        // LLM Integration for "Generar Invitaci√≥n Personalizada"
        generateInvitationBtn.addEventListener('click', async () => {
            invitationOutputContainer.classList.remove('hidden');
            const userCustomInput = invitationInput.value.trim();

            const prompt = `Basado en el siguiente informe de inversi√≥n de Lolocar, redacta un borrador de invitaci√≥n o mensaje persuasivo. Incorpora la siguiente informaci√≥n adicional proporcionada por el usuario para personalizar el mensaje. El mensaje debe ser conciso, profesional y destacar los beneficios clave de la inversi√≥n.

            Informe de Inversi√≥n Lolocar:
            ${fullReportContext}

            Informaci√≥n adicional para personalizar el mensaje: ${userCustomInput || "Ninguna informaci√≥n adicional proporcionada. Redactar un mensaje general."}

            Formato: Un p√°rrafo de introducci√≥n, 3-4 puntos clave en bullet points (usando guiones), y un p√°rrafo de cierre con un llamado a la acci√≥n.`;

            await callGeminiAPI(prompt, invitationOutputContent, invitationLoadingIndicator);
        });


        // Initial load
        updateCharts('5');


        // Calculate and display residual values (already in HTML, this is just for dynamic confirmation if needed)
        const initialInvestment = 7000000;
        const depreciationRate = 0.03;
        document.getElementById('residual-y2').textContent = '$' + (initialInvestment * Math.pow(1 - depreciationRate, 2)).toLocaleString('es-CL', {maximumFractionDigits:0});
        document.getElementById('residual-y3').textContent = '$' + (initialInvestment * Math.pow(1 - depreciationRate, 3)).toLocaleString('es-CL', {maximumFractionDigits:0});
        document.getElementById('residual-y4').textContent = '$' + (initialInvestment * Math.pow(1 - depreciationRate, 4)).toLocaleString('es-CL', {maximumFractionDigits:0});

        // Smooth scroll for navigation links
        document.querySelectorAll('header nav a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                     targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

    </script>
</body>
</html>